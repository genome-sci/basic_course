# シェルスクリプトとバッチジョブ
#### 国立遺伝学研究所　森宙史

### シェルスクリプトとは?

- Linuxのコマンドを、実行してほしい一連の処理を実現できるように順番に並べたもの  
- **変数**や**配列**等のデータ構造を使うことが可能  
- **for文**や**if文**等の基礎的なプログラミングの文法が使える  
(簡易的なものなので、本格的にプログラミングしたいなら、Python等のスクリプト言語を習得すべき)  
なお、Pythonの学習には、今年度の中級者講習会の[資料](https://github.com/genome-sci/python_bioinfo_2018)がオススメ

### なぜシェルスクリプトを学ぶ?

- バイオインフォマティクスの解析では、同じ処理を多数のファイルに対して行うことが多い  
- 特にNGSデータは個々のファイルサイズが大きく各処理に時間がかかるので自動化が重要  
(例: 1run8サンプルの8 x 2 fastqファイルの処理)  
- 遺伝研スパコン含め大抵のスパコンは、計算を投げるマシンと計算を実行するマシンが別であり、そのようなマシンを使うためにはシェルスクリプトの習得が必須  

これからの実習で重要な、遺伝研スパコン上でのシェルスクリプトファイルの編集方法 [(谷澤さんのFileZillaの使い方の解説)](https://www.evernote.com/l/AM3SRVwG6eJLDZojqTgWS_x5csynKJpbI0o)  

### シェルスクリプトの例

1. FileZillaで遺伝研スパコンのホームディレクトリ上に、下記のtimes1.shファイルを作成

times1.sh
```
#!/bin/bash
date
sleep 7
date
```

2. TeraTerm or ターミナル等を用いてsshで遺伝研スパコンにログインし、qlogin後、下記のコマンドを実行
`chmod u+x times1.sh`
`./times1.sh`

3. コードの解説
`#!/bin/bash` は、bashシェルを用いると指定する役割。
`date` は、今の日時を表示
`sleep 7`は7秒間待つ
`chmod u+x`は続くファイルの実行権限を自分自身に与える


